% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/functions.r
\name{estimation}
\alias{estimation}
\title{Instrumental Variable Estimation with Selection Adjustment}
\usage{
estimation(dat)
}
\arguments{
\item{dat}{A tibble containing the simulated data with columns:
\itemize{
\item \code{selection}: Binary selection indicator (0/1)
\item \code{y}: Binary outcome variable (0/1)
\item \code{x1}: Continuous exposure variable 1
\item \code{x2}: Continuous exposure variable 2 (confounder/mediator)
\item \code{prs_x1}: Polygenic risk score instrument for x1
\item \code{prs_x2}: Polygenic risk score instrument for x2
}}
}
\value{
A tibble with estimation results, or NULL if insufficient data:
\describe{
\item{beta}{Point estimate of the causal effect of x1 on y}
\item{se}{Standard error of the estimate}
\item{lower}{Lower bound of 95\% confidence interval}
\item{upper}{Upper bound of 95\% confidence interval}
}
}
\description{
Performs instrumental variable regression to estimate the causal effect of exposure x1
on outcome y, adjusting for exposure x2, using only selected participants. The function
uses polygenic risk scores as instruments for the exposures.
}
\details{
The function first filters to selected participants only (selection == 1).
If fewer than 50 selected participants remain, returns NULL. Otherwise,
performs two-stage least squares regression using \code{ivreg()} with PRS as
instruments. The model regresses y on x1 and x2, instrumented by prs_x1
and prs_x2 respectively.
}
\examples{
\dontrun{
# Generate data and estimate causal effect
data <- dgm(n = 10000, rg = 0.67, prs_beta_x1 = 0.3, prs_beta_x2 = 0.3,
            y_prev = 1/7, x1_sel = 0.1, x2_sel = 0, y_sel = 0.2)
results <- estimation(data)
print(results)
}

}
\seealso{
\code{\link{dgm}} for data generation, \code{\link{simulate_lines}} for simulation studies
}
