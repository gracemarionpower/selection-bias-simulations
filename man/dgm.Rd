% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/functions.r
\name{dgm}
\alias{dgm}
\title{Data Generating Mechanism for Mendelian Randomization with Selection Bias}
\usage{
dgm(n, rg, prs_beta_x1, prs_beta_x2, y_prev, x1_sel, x2_sel, y_sel)
}
\arguments{
\item{n}{Integer. Sample size for the simulation.}

\item{rg}{Numeric. Genetic correlation between x1 and x2 PRS (0-1).}

\item{prs_beta_x1}{Numeric. Effect size of x1 PRS on exposure x1.}

\item{prs_beta_x2}{Numeric. Effect size of x2 PRS on exposure x2.}

\item{y_prev}{Numeric. Prevalence of outcome y in the population (0-1).}

\item{x1_sel}{Numeric. Selection coefficient for exposure x1.
Positive values indicate higher x1 increases selection probability.}

\item{x2_sel}{Numeric. Selection coefficient for exposure x2.
Positive values indicate higher x2 increases selection probability.}

\item{y_sel}{Numeric. Selection coefficient for outcome y.
Positive values indicate outcome y increases selection probability.}
}
\value{
A tibble with the following columns:
\describe{
\item{prs_x1}{Polygenic risk score for exposure x1}
\item{prs_x2}{Polygenic risk score for exposure x2}
\item{x1}{Simulated exposure x1}
\item{x2}{Simulated exposure x2}
\item{y}{Binary outcome y (0/1)}
\item{selection}{Binary selection indicator (0/1)}
}
}
\description{
Simulates a dataset with polygenic risk scores (PRS), exposures x1 and x2,
outcome y, and selection indicators. The function models selection bias where
participation depends on the exposures and outcome.
}
\details{
The function generates correlated polygenic risk scores from a bivariate normal
distribution, then simulates phenotypes with residual variance. Selection probability
is modeled using a logistic function of the linear combination of exposures and
outcome, weighted by their respective selection coefficients.
}
\examples{
\dontrun{
# Basic simulation with moderate selection bias
data <- dgm(
  n = 10000,
  rg = 0.67,
  prs_beta_x1 = 0.3,
  prs_beta_x2 = 0.3,
  y_prev = 1/7,
  x1_sel = 0.1,
  x2_sel = 0,
  y_sel = 0.2
)
}

}
\seealso{
\code{\link{dgm_interaction}} for interaction-based selection bias
}
